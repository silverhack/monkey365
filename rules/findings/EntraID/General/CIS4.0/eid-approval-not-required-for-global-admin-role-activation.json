{
    "args": [
        
    ],
    "provider": "EntraID",
    "serviceType": "Entra Identity Governance",
    "serviceName": "Microsoft Entra ID",
    "displayName": "Ensure approval is required for Global Administrator role activation",
    "description": "Microsoft Entra Privileged Identity Management can be used to audit roles, allow just in time activation of roles and allow for periodic role attestation. Requiring approval before activation allows one of the selected approvers to first review and then approve the activation prior to PIM granted the role. The approver doesn\u0027t have to be a group member or owner. The recommended state is Require approval to activate for the Global Administrator role.",
    "rationale": "Approvers do not need to be assigned the same role or be members of the same group. It\u0027s important to have at least two approvers and an emergency access (break-glass) account to prevent a scenario where no Global Administrators are available. For example, if the last active Global Administrator leaves the organization, and only eligible but inactive Global Administrators remain, a trusted approver without the Global Administrator role or an emergency access account would be essential to avoid delays in critical administrative tasks.",
    "impact": "",
    "remediation": {
        "text": "\r\n\t\t\t###### To remediate using the UI: \r\n\t\t\t1. Navigate to Microsoft Entra admin center https://entra.microsoft.com/. \r\n\t\t\t2. Click to expand Identity Governance select Privileged Identity Management. \r\n\t\t\t3. Under Manage select Microsoft Entra Roles. \r\n\t\t\t4. Under Manage select Roles. \r\n\t\t\t5. Select Global Administrator in the list. \r\n\t\t\t6. Select Role settings and click Edit. \r\n\t\t\t7. Check the Require approval to activate box. \r\n\t\t\t8. Add at least two approvers. \r\n\t\t\t9. Click Update. \r\n\t",
        "code": {
            "powerShell": null,
            "iac": null,
            "terraform": null,
            "other": null
        }
    },
    "recommendation": null,
    "references": [
        "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-configure",
        "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/groups-role-settings#require-approval-to-activate"
    ],
    "compliance": [
        {
            "name": "CIS Microsoft 365 Foundations Benchmark",
            "version": "5.0.0",
            "reference": "5.3.4",
            "profile": "E5 Level 1"
        }
    ],
    "level": "medium",
    "tags": [
        
    ],
    "rule": {
        "path": "aad_pim_roleAssignment",
        "subPath": null,
        "selectCondition": {
            
        },
		"data": {
            "properties": {
                "policy.settings.@odata.type": "@odata.type",
				"policy.settings.id": "policyId",
				"policy.settings.setting": "policySetting",
                "displayName": "displayName",
                "description": "description",
                "templateId": "templateId"
            },
            "expandObject": "policy.settings"
        },
        "query": [
			{
                "filter": [
                    {
                        "conditions": [
							[
                                "templateId",
                                "eq",
								"62e90394-69f5-4237-9190-012177145e10"
                            ],
							[
                                "@odata.type",
                                "like",
								"*unifiedRoleManagementPolicyApprovalRule*"
                            ]
                        ],
						"operator":"and"
                    }
                ]
            },
			{
				"connectOperator": "and",
                "filter": [
                    {
                        "conditions": [
							[
                                "isApprovalRequired",
                                "eq",
								"False"
                            ],
							[
                                "approvalStages.primaryApproversCount",
                                "lt",
								"2"
                            ]
                        ],
						"operator":"or",
						"whereObject":"policySetting"
                    }
                ]
            }
        ],
        "shouldExist": null,
        "returnObject": null,
        "removeIfNotExists": null
    },
    "output": {
        "html": {
            "data": {
                "properties": {
					"templateId": "templateId",
                    "displayName": "displayName",
                    "description": "description",
                    "policySetting.isApprovalRequired": "Approval Required",
					"policySetting.approvalStages.primaryApproversCount": "Primary Approvers Count"
                }
            },
            "table": null,
            "decorate": [
                
            ],
            "emphasis": [
                
            ],
            "actions": {
                "objectData": {
                    "properties": [
                        "*"
                    ],
                    "expandObject": null,
                    "limit": null
                },
                "showGoToButton": false,
                "showModalButton": false,
                "directLink": null
            }
        },
        "text": {
            "data": {
                "properties": {
					"templateId": "templateId",
                    "displayName": "displayName",
                    "description": "description",
                    "policySetting.isApprovalRequired": "Approval Required",
					"policySetting.approvalStages.primaryApproversCount": "Primary Approvers Count"
                }
            },
            "status": {
                "keyName": "",
                "message": "Ensure approval is required for Global Administrator role activation",
                "defaultMessage": "Ensure approval is required for Global Administrator role activation"
            },
            "properties": {
                "resourceName": "displayName",
                "resourceId": "templateId",
                "resourceType": "PIMUnifiedRoleManagementPolicyApprovalRule"
            },
            "onlyStatus": false
        }
    },
    "idSuffix": "eid_approval_for_global_admin_not_enabled",
    "notes": [
        
    ],
    "categories": [
        
    ],
    "immutable_properties": [
		"templateId",
		"displayName"
    ],
    "id": "entraid_1128"
}
