{
    "args": [
        
    ],
    "provider": "EntraID",
    "serviceType": "General",
    "serviceName": "Microsoft Entra ID",
    "displayName": "Ensure Security Defaults is enabled on Microsoft Entra ID",
    "description": "\r\n\t\t\t\t\t#### IMPORTANT - Please read the section overview\r\n\t\t\t\t\tIf your organization pays for Microsoft Entra ID licensing (included in Microsoft 365 E3, E5, or F5, and EM\u0026S E3 or E5 licenses) and CAN use Conditional Access, ignore the recommendations in this section and proceed to the Conditional Access section. \u003cbr/\u003e  Security defaults in Microsoft Entra ID make it easier to be secure and help protect your organization. Security defaults contain preconfigured security settings for common attacks. \u003cbr/\u003e Security defaults is available to everyone. The goal is to ensure that all organizations have a basic level of security enabled at no extra cost. You may turn on security defaults in the Azure portal.",
    "rationale": "Security defaults provide secure default settings that we manage on behalf of organizations to keep customers safe until they are ready to manage their own identity security settings. \u003cbr/\u003e For example, doing the following: \u003cbr/\u003e * Requiring all users and admins to register for MFA. \u003cbr/\u003e * Challenging users with MFA - when necessary, based on factors such as location, device, role, and task. \u003cbr/\u003e * Disabling authentication from legacy authentication clients, which canÃ¢â‚¬â„¢t do MFA.",
    "impact": "This recommendation should be implemented initially and then may be overridden by other service/product specific CIS Benchmarks. Administrators should also be aware that certain configurations in Microsoft Entra ID may impact other Microsoft services such as Microsoft 365.",
    "remediation": {
        "text": "###### From Azure Portal \u003cbr/\u003e To enable security defaults in your directory: \u003cbr/\u003e 1. From Azure Home select the Portal Menu. \u003cbr/\u003e 2. Browse toÃ¢â‚¬Â¯`Microsoft Entra ID`Ã¢â‚¬Â¯\u003eÃ¢â‚¬Â¯Properties \u003cbr/\u003e 3. Select `Manage security defaults` \u003cbr/\u003e 4. Under `Security defaults`, select `Enabled (recommended)`. \u003cbr/\u003e 5. Select `Save`",
        "code": {
            "powerShell": null,
            "iac": null,
            "terraform": null,
            "other": null
        }
    },
    "recommendation": null,
    "references": [
        "https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/users-default-permissions",
        "http://www.rebeladmin.com/2019/04/step-step-guide-restrict-azure-ad-administration-portal/",
        "https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/concept-fundamentals-security-defaults",
        "https://techcommunity.microsoft.com/t5/azure-active-directory-identity/introducing-security-defaults/ba-p/1061414"
    ],
    "compliance": [
        {
            "name": "CIS Microsoft 365 Foundations",
            "version": "3.0.0",
            "reference": "2.1.1",
            "Profile": "Level 1"
        }
    ],
    "level": "medium",
    "tags": [
        
    ],
    "rule": {
        "path": "aad_security_default_status",
        "subPath": null,
        "selectCondition": {
            
        },
        "query": [
            {
                "filter": [
                    {
                        "conditions": [
                            [
                                "securityDefaultsEnabled",
                                "eq",
                                "False"
                            ]
                        ]
                    }
                ]
            }
        ],
        "shouldExist": null,
        "returnObject": null,
        "removeIfNotExists": null
    },
    "output": {
        "html": {
            "data": {
                "properties": {
                    
                },
                "expandObject": null
            },
            "table": null,
            "decorate": [
                
            ],
            "emphasis": [
                
            ],
            "actions": {
                "objectData": {
                    "properties": [
                        "*"
                    ],
                    "expandObject": null,
                    "limit": null
                },
                "showGoToButton": false,
                "showModalButton": false,
                "directLink": null
            }
        },
        "text": {
            "data": {
                "properties": {
                    
                },
                "expandObject": null
            },
            "status": {
                "keyName": [
                    
                ],
                "message": "Security Defaults is disabled",
                "defaultMessage": null
            },
            "properties": {
                "resourceName": null,
                "resourceId": null,
                "resourceType": null
            },
            "onlyStatus": false
        }
    },
    "idSuffix": "aad_sbd_disabled",
    "notes": [
        
    ],
    "categories": [
        
    ],
    "immutable_properties": [
        
    ],
    "id": "entraid_1160"
}
