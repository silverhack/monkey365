{
    "dashboard_name":  "SQL Server",
    "menu_name":  "Databases",
    "issue_name":  "Ensure that VA setting Periodic Recurring Scans is enabled on a SQL server",
    "description":  "Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.",
    "rationale":  "VA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibility based on updated known vulnerability signatures and best practices.",
    "impact":  "Enabling the **Azure Defender** for SQL features will incur additional costs for each SQL server.",
    "remediation":  '
					###### From Azure Console
					1. Go to `SQL servers`.
					2. Select a server instance
					3. Click on `Security Center`
					4. Ensure that `Azure Defender for SQL` is set to `Enabled`
					5. In Section `Vulnerability Assessment Settings`, Ensure Storage Accounts is configured.
					6. In Section `Vulnerability Assessment Settings`, Ensure Periodic recurring scans is set to `On`
	',
    "references":  [
                       "https://docs.microsoft.com/en-us/azure/sql-database/sql-vulnerability-assessment",
					   "https://docs.microsoft.com/en-us/rest/api/sql/servervulnerabilityassessments/listbyserver",
					   "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Update-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0",
					   "https://docs.microsoft.com/en-in/powershell/module/Az.Sql/Get-AzSqlServerVulnerabilityAssessmentSetting?view=azps-2.6.0",
					   "https://docs.microsoft.com/en-us/azure/security/benchmarks/security-controls-v2-posture-vulnerability-management#pv-6-perform-software-vulnerability-assessment"
                   ],
    "compliance":  [
                       {
                           "name":  "CIS Microsoft Azure Foundations",
                           "version":  "1.4.0",
                           "reference":  "4.2.3"
                       }
                   ],
    "tags":  null,
    "path":  "az_sql_servers",
    "display_path":  "az_sql_servers",
    "conditions":  [
                       "and",
                       [
                           "vulnerabilityAssessmentConfig.properties.recurringScans.isEnabled",
                           "eq",
                           "False"
                       ]
                   ],
    "id_suffix":  "sql_server_va_periodic_disabled"
}
